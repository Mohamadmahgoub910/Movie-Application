@using MovieApp.Core.Entities
@model Movie
@{
    ViewData["Title"] = Model.Name;
}

<style>
    .movie-details {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .movie-poster {
        width: 100%;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }

    .info-badge {
        display: inline-block;
        padding: 0.5rem 1rem;
        border-radius: 10px;
        margin-right: 0.5rem;
        margin-bottom: 0.5rem;
    }

    .actor-card {
        text-align: center;
        margin-bottom: 1.5rem;
    }

        .actor-card img {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 50%;
            margin-bottom: 0.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

    .gallery-img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        border-radius: 10px;
        cursor: pointer;
        transition: transform 0.3s ease;
    }

        .gallery-img:hover {
            transform: scale(1.05);
        }
</style>

<div class="mb-4">
    <a asp-action="Index" class="btn btn-outline-secondary">
        <i class="fas fa-arrow-right me-2"></i>رجوع للأفلام
    </a>
   
</div>

<div class="movie-details">
    <div class="row">
        <!-- Movie Poster -->
        <div class="col-md-4 mb-4">
            <img src="@(string.IsNullOrEmpty(Model.MainImage) ? "/images/placeholder.jpg" : Model.MainImage)"
                 alt="@Model.Name" class="movie-poster" />
        </div>

        <!-- Movie Info -->
        <div class="col-md-8">
            <h1 class="mb-3">@Model.Name</h1>

            <div class="mb-3">
                <span class="info-badge bg-primary text-white">
                    <i class="fas fa-tag me-1"></i>@Model.Category?.Name
                </span>
                <span class="info-badge bg-info text-white">
                    <i class="fas fa-building me-1"></i>@Model.Cinema?.Name
                </span>
                <span class="info-badge @(Model.Status == MovieStatus.NowShowing ? "bg-success" : Model.Status == MovieStatus.ComingSoon ? "bg-warning" : "bg-secondary") text-white">
                    @(Model.Status == MovieStatus.NowShowing ? "يُعرض الآن" : Model.Status == MovieStatus.ComingSoon ? "قريباً" : "انتهى العرض")
                </span>
            </div>

            <div class="row mb-4">
                <div class="col-md-6">
                    <h3 class="text-primary">@Model.Price.ToString("C")</h3>
                </div>
                <div class="col-md-6">
                    <p class="mb-1">
                        <i class="fas fa-calendar text-primary me-2"></i>
                        <strong>تاريخ العرض:</strong> @Model.ReleaseDateTime.ToString("dd/MM/yyyy")
                    </p>
                    @if (Model.Duration.HasValue)
                    {
                        <p class="mb-1">
                            <i class="fas fa-clock text-primary me-2"></i>
                            <strong>المدة:</strong> @Model.Duration دقيقة
                        </p>
                    }
                </div>
            </div>

            <h4 class="mb-2"><i class="fas fa-info-circle me-2"></i>نبذة عن الفيلم</h4>
            <p class="text-muted">@Model.Description</p>
        </div>
    </div>

    <!-- Actors Section -->
    @if (Model.MovieActors.Any())
    {
        <hr class="my-4" />
        <h3 class="mb-4">
            <i class="fas fa-users me-2"></i>
            الممثلين
        </h3>
        <div class="row">
            @foreach (var movieActor in Model.MovieActors)
            {
                <div class="col-md-2 col-6">
                    <div class="actor-card">
                        <img src="@(string.IsNullOrEmpty(movieActor.Actor.ProfilePicture) ? "/images/placeholder-actor.jpg" : movieActor.Actor.ProfilePicture)"
                             alt="@movieActor.Actor.Name" />
                        <h6>@movieActor.Actor.Name</h6>
                    </div>
                </div>
            }
        </div>
    }

    <!-- Gallery Section -->
    @if (Model.SubImages.Any())
    {
        <hr class="my-4" />
        <h3 class="mb-4">
            <i class="fas fa-images me-2"></i>
            معرض الصور
        </h3>
        <div class="row">
            @foreach (var image in Model.SubImages)
            {
                <div class="col-md-3 col-6 mb-3">
                    <img src="@image.ImageUrl" alt="صورة من الفيلم" class="gallery-img"
                         onclick="openImage('@image.ImageUrl')" />
                </div>
            }
        </div>
    }
</div>

@section Scripts {
    <script>
        function openImage(url) {
            window.open(url, '_blank');
        }
    </script>
}